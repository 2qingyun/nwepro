<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<link rel="stylesheet" href="./CSS/framework.css">
	<link rel="stylesheet" href="./CSS/commodiy.css">
	<link rel="stylesheet" href="./CSS/xcConfirm.css">
	<body>
		<div>
			<!-- 标题部分 -->
			<div class='tele'>
				<span>在线时间&nbsp;&nbsp;08:30~21:30</span>
				<span>欢迎访问清风茶木在线商城！</span>
				<span
					class="span_time">当前时间：<span>2022年</span><span>10月</span><span>20号</span><span>时</span><span>分</span><span>秒</span></span>
				<div>
					<a style="display: none;">用户</a>
					<a href="./enter.html" onclick="logout()">注销</a>
					<a href="./enter.html" style="display: none;">登录</a>
					<a href="./register.html">注册</a>
					<img src="./IMG/cart.png" style="height: 27px;">
				</div>
			</div>
			<div class="navigate">
				<img src="./IMG/tea.png" alt="茶道" style="height: 100px;">

				<a href="./head.html">商城首页</a>
				<a href="./classify.html">商品分类</a>
				<a href="./shoppingCart.html">我的道馆</a>
				<a href="./text.html">关于茶道</a>
				<input type="text" placeholder="茶道/花道/香道">
				<img src="./IMG/search.png" style="height: 40px;">
			</div>
		</div>
		<!-- 商品详细页内容 -->
		<div class="primary">
			<div class="describe">
				<div class="type">
					<span>首页</span>
					<span>属性1</span>
					<span>属性2</span>
					<span>属性3</span>
				</div>
				<div class="Img">
					<img src="./IMG/goodsimg/3.png" style="width: 200px;height: 200px;">
					<div>
						<h1 style="font-size: 20px;font-family: 宋体;color: #0C0C0C;">商品名字</h1>
						<span style="font-size: 26px;font-family: 'Times New Roman';color: #c90000;">￥3800</span><br>
						<span class="Songtypeface" style="border-top: 2px dotted #ddd;">商品分类：
							<a href="" class="Songtypeface" style="color: #c90000;">属性1</a>
							<a href="" class="Songtypeface" style="color: #c90000;">属性2</a><br>
						</span>
						<button id="btn5">加入购物车</button>
					</div>
				</div>
				<div class="Img"><img src="./IMG/goodsimg/3.png" style="width: 60px;"></div>
				<div>
					<a href="">用户评论&nbsp;(0)</a>
					<ul style="border-top: 3px solid #eee;border-bottom: 1px dotted #ddd;">
						<li>目前还未有评论</li>
						<li>只有买过此商品的客户登录后才可以发表并查看评论</li>
					</ul>
				</div>
				<li class="clone" style="display: none;">
					<img src="./IMG/goodsimg/1.png" alt="">
					<span>锡制茶叶罐</span><br>
					<span style="color:#aaaaaa;">￥5600</span>
				</li>
				<div class="correlation">
					<h2 style="font-size: 14px;font-family">相关商品</h2>
				</div>
			</div>
			<div class="recommend">
				<div style="background: #c90000;"><span
						style="font-size:15px;color:#ffffff;margin: 19px 25px;">金牌店铺，值得信赖</span></div>
				<div>
					<span>清风茶木</span>
					<span style="font-family:'Times New Roman';">AOKI&nbsp;OF&nbsp;TEA</span>
				</div>
				<div style="background: #f7f7f7;">
					<span>信譽：</span>
					<span style="color: red;">❤❤❤❤❤</span>
				</div>
				<div>
					<span>聯繫：<a href=""
							style="background: #c90000;color: #fff;display: inline-block;width: 100px;">聯繫我們</a>
					</span>
				</div>
				<div style="background: #f7f7f7;">
					<span>描述：4.9</span>
				</div>
				<div>
					<span>服務：4.9</span>
				</div>
				<div style="background: #f7f7f7;">
					<span>物流：4.9</span>
				</div>
				<div style="border-bottom: 1px dotted #ddd;">
					<span style="margin: 7px 66px ;">熱賣商品</span>
					<span style="margin: 0 62px ;"> HOT&nbsp;SALE</span>
				</div>
				<ul class="ul_content">
					<li class="li_clone" style="display: none;">
						<img src="./IMG/goodsimg/1.png" alt="">
						<span>锡制茶叶罐</span><br>
						<span>￥5600</span>
				</ul>
			</div>
		</div>


		<!-- 底部内容 -->
		<div class="bottom">
			<div>
				<span>About&nbsp;Change</span>
				<div><span>本店商品均为易碎品，非质量问题谢绝退换，如有质量问题，本店诚担运费调换</span></div>
				<span>Online&nbsp;Payment</span>
				<div>
					<img src="./IMG/./buttonImg/./zhifu1.png">
					<img src="./IMG/./buttonImg/./zhifu2.png">
					<img src="./IMG/./buttonImg/./zhifu3.png">
				</div>
			</div>
			<div>
				<span>Service</span>
				<div><span>消费者保障服务、七天无理由退款、假一赔三</span></div>
				<span>Online&nbsp;Payment</span>
			</div>
			<div>
				<span>About&nbsp;Color</span>
				<div><span>本店商品均为易碎品，非质量问题谢绝退换，如有质量问题，本店诚担运费调换</span></div>
				<span>Wechat</span>
			</div>
			<div>
				<div><img src="./IMG/tea.png" style="height: 100px;width: 88px;"></div>
				<br><span>Social&nbsp;APP</span>
				<div><img src="./IMG/buttonImg/zhifu4.png" style="height: 20px;width: 115px;"></div>
			</div>
		</div>

		</div>
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
		<script src="JS/event.js"></script>
		<script src="JS/jquery.niceHover.js"></script>
		<script src="JS/xcConfirm.js"></script>
		<script>
			$(function() {
				var arr = window.localStorage.getItem('Commodity') //获取缓存
				var url = JSON.parse(arr) //转化为对象
				//重新获取详情页面的商品数据
				$('div.primary>div.describe>div.Img>img').attr('src', url.url) //图片路径

				$('div.primary>div.describe>div.Img>div>span').eq(0).html(url.price) //商品价格

				$('div.primary>div.describe>div.Img>div>h1').html(url.name) //商品名字

				$('div.primary>div.describe>div.type>span').eq(1).html(url.type) //商品类型

				$('div.primary>div.describe>div.type>span').eq(2).html(url.kind) //商品属性

				$('div.primary>div.describe>div.type>span').eq(3).html(url.name) //商品属性一

				$('div.primary>div.describe>div.Img>div>span.Songtypeface>a').eq(0).html(url.type) //超链接内容

				$('div.primary>div.describe>div.Img>div>span.Songtypeface>a').eq(1).html(url.kind) //超链接内容

				$('div.primary>div.describe>div.Img>div>button').click(function() {
					var shoppingCart = JSON.parse(window.localStorage.getItem('ShoppingCart'))
					var att = JSON.parse(arr)
					att.sum = 1
					var sum = 0
					for (var key in shoppingCart) { //判断商品是否存在
						if (shoppingCart[key].name == att.name) {
							var i = shoppingCart[key].sum
							shoppingCart[key].sum = i + 1;
							sum++
							window.localStorage.setItem('ShoppingCart', JSON.stringify(shoppingCart))
						}
					}
					if (sum == 0) { //商品不存在 则添加
						shoppingCart.push(att)
						window.localStorage.setItem('ShoppingCart', JSON.stringify(shoppingCart))
					}
				})
				//相关商品商品的显示
				$.getJSON('data.json', function(json) {
					var the_relevant = []
					var data = json
					var tea_sum = 0


					for (var i = 0; i < data.length; i++) { //遍历json数据
						for (var j = 0; j < data[i].data.length; j++) {
							if (data[i].data[j].kind == url.kind) {
								for (var sum = 0; sum < data[i].data[j].data.length; sum++) {
									if (tea_sum >= 4) {
										break;
									}
									var li = $('li.clone').clone(true)
									$(li).removeAttr('style')
									$(li).removeAttr('class')
									li.find('img').attr('src', data[i].data[j].data[sum].url)
									li.find('span').eq(0).html(data[i].data[j].data[sum].name)
									li.find('span').eq(1).html(data[i].data[j].data[sum].price)
									var obj = {
										name: data[i].data[j].data[sum].name,
										price: data[i].data[j].data[sum].price,
										url: data[i].data[j].data[sum].url,
										type: data[i].type,
										kind: data[i].data[j].kind
									}
									the_relevant.push(obj)
									$(li).click(function() { //给每一个li添加一个点击事件
										window.localStorage.setItem('Commodity', JSON.stringify(
											the_relevant[$(this).index() - 1]))
										window.location.assign('./commodity.html')
									})
									$('div.correlation').append(li)
									tea_sum++
								}
							}

						}
					}
				})
				//热卖商品的遍历
				$.getJSON('data.json', function(json) {
					var data = json
					var tea_sum = 0
					var the_recommend = []
					var random = Math.floor(Math.random() * 4) //第一层选择
					for (var i = 0; i < 4; i++) { //第二层选择
						for (var j = 0; j < data[2].data[i].data.length; j++) { //具体商品选择
							if (tea_sum >= 6) {
								break;
							}
							var li = $('li.li_clone').clone(true)
							$(li).removeAttr('style')
							$(li).removeAttr('class')
							li.find('img').attr('src', data[2].data[i].data[j].url)
							li.find('span').eq(0).html(data[2].data[i].data[j].name)
							li.find('span').eq(1).html(data[2].data[i].data[j].price)
							var obj = {
								name: data[2].data[i].data[j].name, //商品名字
								price: data[2].data[i].data[j].price, //商品价格
								url: data[2].data[i].data[j].url, //图地址
								type: data[2].type, //商品类型
								kind: data[2].data[i].kind //商品属性
							}
							the_recommend.push(obj)
							$(li).click(function() { //给每一个li添加一个点击事件
								console.log(the_recommend[$(this).index() - 1])

								window.localStorage.setItem('Commodity', JSON.stringify(the_recommend[$(
									this).index() - 1]))
								window.location.assign('./commodity.html')
							})
							$('ul.ul_content').append(li)
							tea_sum++
						}
					}

				})
				//绑定添加购物车成功，并弹框提升
				$("#btn5").click(function() {
					var txt = "商品名称：" + url.name + " 商品价格：" + url.price + "    " + "成功添加至您的购物车!";
					window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.success);
				});


			})
		</script>
	</body>
</html>
